@model IEnumerable<WebMoHinh.Models.Order>

@{
    @if (User.IsInRole("Admin"))
    {
        ViewData["Title"] = "Đơn Hàng";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }

}
<link rel="stylesheet" href="~/css/site.css"/>
@if (User.IsInRole("Admin"))
{
    
    <h1 class="text-center mb-4">Danh Sách Đơn Hàng</h1>

<p>
    <a href="#" onclick="confirmCreateOrder()" class="btn btn-primary">Tạo Đơn Hàng Mới</a>
</p>

<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr class="text-center">
                <th>Ngày Đặt Hàng</th>
                <th>Tổng Trị Giá</th>
                <th>Địa Chỉ Nhận Hàng</th>
                <th>Ghi Chú</th>
                <th>Mã Khách Hàng</th>
                <th>Hành Động</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@item.OrderDate.ToShortDateString()</td>
                    <td>@item.TotalPrice.ToString("")0 VNĐ</td>
                    <td>
                        @if (string.IsNullOrEmpty(item.ShippingAddress))
                        {
                            <i class="fas fa-times"></i> <!-- Đây là icon "times" của Font Awesome -->
                        }
                        else
                        {
                            @item.ShippingAddress
                        }
                    </td>
                    <td>
                        @if (string.IsNullOrEmpty(item.Notes))
                        {
                            <i class="fas fa-times"></i> <!-- Đây là icon "times" của Font Awesome -->
                        }
                        else
                        {
                            @item.Notes
                        }
                    </td>
                    @{
                        Random random = new Random();
                        string randomDigits = new string(Enumerable.Repeat("0123456789", 5)
                        .Select(s => s[random.Next(s.Length)]).ToArray());
                    }
                    <td>@randomDigits</td>
                    <td>
                        <div class="btn-group" role="group">
                                <a onclick="confirmEdit(@item.Id, this)" class="btn btn-sm btn-primary">chỉnh sửa</a>
                               @* <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-info">Details</a>*@
                            <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger">Delete</a>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<script>

        function confirmCreateOrder() {
            if (confirm("Bạn có chắc chắn muốn tạo đơn hàng mới?")) {
                window.location.href = '@Url.Action("Create", "Orders")';
            } else {
                window.location.href = "/Orders";
            }
        }

        function confirmEdit(orderId) {          
            alert("Bạn không được phép chỉnh sửa đơn hàng.")
            button.style.display = 'none';
        }
</script>
}
else
{
    ViewData["Title"] = "Truy Cập Trái Phép";

    <h2 style="color: red; text-align: center"><strong>Quyền Truy Cập Không Hợp Lệ</strong></h2>
    <script>
        setTimeout(function () {
            console.log("Đã chờ xong!");
            window.location.href = "/Home";
        }, 3000);
    </script>
}


